<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulasi Tabungan Berjangka</title>
  <style>
    :root{
      --brand:#0066cc;
      --brand-dark:#004999;
      --bg:#f5f7fb;
      --card:#ffffff;
      --muted:#6b7280;
      --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      background:var(--bg);
      color:#111827;
    }
    header{
      background:var(--brand);
      color:#fff;
      padding:16px 20px;
      text-align:center;
    }
    main{
      max-width:1100px;
      margin:24px auto 56px;
      padding:0 16px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:12px;
      box-shadow:0 6px 14px rgba(0,0,0,.06);
      padding:18px;
    }
    .chooser{display:grid;gap:16px;grid-template-columns:repeat(1,minmax(0,1fr));}
    @media(min-width:700px){.chooser{grid-template-columns:repeat(3,minmax(0,1fr));}}
    .product{border:1px solid var(--border);border-radius:12px;padding:16px;cursor:pointer;transition:.12s;user-select:none;background:#fff;}
    .product:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.08);border-color:#d1d5db;}
    .product h3{margin:0 0 6px;color:var(--brand);font-size:1.05rem;}
    .product .meta{color:var(--muted);font-size:.9rem;}
    .hidden{display:none!important;}
    .form-wrap{display:grid;gap:18px;}
    .row{display:grid;gap:12px;grid-template-columns:1fr;}
    @media(min-width:700px){.row.two{grid-template-columns:1fr 1fr}.row.three{grid-template-columns:1fr 1fr 1fr}}
    label{display:block;font-weight:600;margin-bottom:6px;}
    select,input[type="text"]{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:10px;font-size:1rem;background:#fff;outline:none;}
    select:focus,input[type="text"]:focus{border-color:var(--brand);box-shadow:0 0 0 3px rgba(0,102,204,.12);}
    .actions{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    .btn{appearance:none;border:0;border-radius:10px;padding:10px 14px;font-weight:600;cursor:pointer;transition:.15s;}
    .btn-primary{background:var(--brand);color:#fff;}
    .btn-primary:hover{background:var(--brand-dark);}
    .btn-ghost{background:#fff;border:1px solid var(--border);color:#111827;}
    .btn-ghost:hover{background:#f9fafb;}
    .muted{color:var(--muted);}
    .result{margin-top:14px;padding:14px;background:#eef6ff;border:1px solid #cfe7ff;border-radius:10px;overflow:auto;}
    .summary{display:grid;gap:8px;grid-template-columns:repeat(1,minmax(0,1fr));}
    @media(min-width:900px){.summary{grid-template-columns:repeat(5,minmax(0,1fr));}}
    .pill{background:#fff;border:1px solid #dbeafe;border-radius:10px;padding:10px 12px;}
    .pill b{display:block;font-size:.95rem;color:#0f172a;}
    .pill span{color:#334155;font-size:.9rem;}
    table{width:100%;border-collapse:collapse;margin-top:12px;font-size:.95rem;background:#fff;border:1px solid var(--border);border-radius:10px;overflow:hidden;}
    thead th{position:sticky;top:0;background:var(--brand);color:#fff;padding:8px;text-align:center;}
    tbody td{border-top:1px solid var(--border);padding:8px;text-align:right;}
    tbody td:first-child,thead th:first-child{text-align:center;}
    .footer-note{margin-top:10px;font-size:.9rem;color:#475569;}
    .header-flex{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px;}
  </style>
</head>
<body>
<main>
  <!-- STEP 1 -->
  <section id="step-choose" class="card">
    <h1 style="margin:0">Simulasi Tabungan Berjangka</h1>
    <h2 style="margin:0">Pilih Jenis Tabungan</h2>
    <div class="chooser">
      <div class="product" onclick="selectProduct('cordelia')">
        <h3>Cordelia Ceremony</h3>
        <div class="meta">Tenor 1–3 tahun • Bunga 1% p.a.</div>
      </div>
      <div class="product" onclick="selectProduct('elara')">
        <h3>Tabungan Elara (Tanpa Setoran Awal)</h3>
        <div class="meta">Tenor 1–5 tahun • Bunga 4% p.a.</div>
      </div>
      <div class="product" onclick="selectProduct('elaraAwal')">
        <h3>Tabungan Elara (Dengan Setoran Awal)</h3>
        <div class="meta">Tenor 1–5 tahun • Bunga 5% p.a.</div>
      </div>
    </div>
  </section>

  <!-- FORM CORDELIA -->
  <section id="form-cordelia" class="card hidden">
    <div class="header-flex"><h2>Cordelia Ceremony</h2><button class="btn btn-ghost" onclick="backToChoose()">← Kembali</button></div>
    <div class="form-wrap">
      <div class="row two">
        <div><label>Jangka Waktu</label>
          <select id="cordelia-tenor"><option value="1">1 Tahun</option><option value="2">2 Tahun</option><option value="3">3 Tahun</option></select>
        </div>
        <div><label>Setoran per Bulan</label><input type="text" id="cordelia-setoran" class="thousand" placeholder="contoh: 1.000.000"/></div>
      </div>
      <div class="actions"><button class="btn btn-primary" id="btn-cordelia">Hitung</button></div>
      <div id="cordelia-result" class="result hidden"></div>
    </div>
  </section>

  <!-- FORM ELARA -->
  <section id="form-elara" class="card hidden">
    <div class="header-flex"><h2>Tabungan Elara (Tanpa Setoran Awal)</h2><button class="btn btn-ghost" onclick="backToChoose()">← Kembali</button></div>
    <div class="form-wrap">
      <div class="row two">
        <div><label>Jangka Waktu</label>
          <select id="elara-tenor"><option value="1">1 Tahun</option><option value="2">2 Tahun</option><option value="3">3 Tahun</option><option value="4">4 Tahun</option><option value="5">5 Tahun</option></select>
        </div>
        <div><label>Setoran per Bulan</label><input type="text" id="elara-setoran" class="thousand" placeholder="contoh: 1.000.000"/></div>
      </div>
      <div class="actions"><button class="btn btn-primary" id="btn-elara">Hitung</button></div>
      <div id="elara-result" class="result hidden"></div>
    </div>
  </section>

  <!-- FORM ELARA AWAL -->
  <section id="form-elaraAwal" class="card hidden">
    <div class="header-flex"><h2>Tabungan Elara (Dengan Setoran Awal)</h2><button class="btn btn-ghost" onclick="backToChoose()">← Kembali</button></div>
    <div class="form-wrap">
      <div class="row three">
        <div><label>Jangka Waktu</label>
          <select id="elaraAwal-tenor"><option value="1">1 Tahun</option><option value="2">2 Tahun</option><option value="3">3 Tahun</option><option value="4">4 Tahun</option><option value="5">5 Tahun</option></select>
        </div>
        <div><label>Setoran Awal</label><input type="text" id="elaraAwal-setoranAwal" class="thousand" placeholder="contoh: 5.000.000"/></div>
        <div><label>Setoran per Bulan</label><input type="text" id="elaraAwal-setoran" class="thousand" placeholder="contoh: 1.000.000"/></div>
      </div>
      <div class="actions"><button class="btn btn-primary" id="btn-elaraAwal">Hitung</button></div>
      <div id="elaraAwal-result" class="result hidden"></div>
    </div>
  </section>
</main>

<script>
  const formatID=n=>new Intl.NumberFormat('id-ID').format(n??0);
  const formatRupiah=n=>"Rp "+formatID(Math.round(n??0));
  const onlyDigits=s=>(s??"").toString().replace(/\D+/g,"");
  const parseThousandInput=el=>Number(onlyDigits(el.value)||0);
  const applyThousandFormat=el=>{const d=onlyDigits(el.value);el.value=d?formatID(Number(d)):"";};
  const attachThousandHandlers=()=>{document.querySelectorAll('input.thousand').forEach(el=>{el.addEventListener('input',()=>applyThousandFormat(el));el.addEventListener('blur',()=>applyThousandFormat(el));});};
  const show=id=>document.getElementById(id).classList.remove('hidden');
  const hide=id=>document.getElementById(id).classList.add('hidden');
  const clearNode=node=>node&&(node.innerHTML="");

  function selectProduct(key){
    hide('step-choose');['form-cordelia','form-elara','form-elaraAwal'].forEach(hide);
    const map={cordelia:'form-cordelia',elara:'form-elara',elaraAwal:'form-elaraAwal'};
    show(map[key]);
    ['cordelia-result','elara-result','elaraAwal-result'].forEach(id=>{hide(id);clearNode(document.getElementById(id));});
  }
  function backToChoose(){['form-cordelia','form-elara','form-elaraAwal'].forEach(hide);show('step-choose');}

  function simulasiBulanan({setoranBulanan, tenorTahun, bungaTahunan, setoranAwal=0}){
    const months=tenorTahun*12;
    const rMonthly=bungaTahunan/12;
    const pajakRate=0.20;
    const pajakMin=7500000; // saldo minimal kena pajak

    let saldo=Number(setoranAwal||0);
    let totalSetoran=Number(setoranAwal||0);
    let totalBungaKotor=0, totalPajak=0, totalBungaBersih=0;

    const rows=[];
    for(let i=1;i<=months;i++){
      const saldoAwal=saldo;

      let bungaKotor=0,pajakBulan=0,bungaBersih=0;
      if(i>1){ // bunga mulai bulan ke-2
        bungaKotor=saldoAwal*rMonthly;
        if(saldoAwal>=pajakMin){
          pajakBulan=bungaKotor*pajakRate;
        }
        bungaBersih=bungaKotor-pajakBulan;
        saldo+=bungaBersih;
      }

      saldo+=setoranBulanan;
      totalSetoran+=setoranBulanan;

      totalBungaKotor+=bungaKotor;
      totalPajak+=pajakBulan;
      totalBungaBersih+=bungaBersih;

      rows.push({
        bulan:i,
        saldoAwal,
        setoranAwal:(i===1?setoranAwal:0),
        setoran:setoranBulanan,
        bungaKotor,
        pajak:pajakBulan,
        bungaBersih,
        saldo
      });
    }

    return{rows,ringkasan:{totalSetoran,totalBungaKotor,totalPajak,totalBungaBersih,saldoAkhir:saldo}};
  }

  function renderTabel(container,rows,ringkasan){
    container.innerHTML=`
    <div class="summary">
      <div class="pill"><b>Total Setoran</b><span>${formatRupiah(ringkasan.totalSetoran)}</span></div>
      <div class="pill"><b>Total Bunga Kotor</b><span>${formatRupiah(ringkasan.totalBungaKotor)}</span></div>
      <div class="pill"><b>Total Pajak (20%)</b><span>${formatRupiah(ringkasan.totalPajak)}</span></div>
      <div class="pill"><b>Total Bunga Bersih</b><span>${formatRupiah(ringkasan.totalBungaBersih)}</span></div>
      <div class="pill"><b>Saldo Akhir</b><span>${formatRupiah(ringkasan.saldoAkhir)}</span></div>
    </div>
    <table>
      <thead>
        <tr>
          <th>Bulan</th>
          <th>Saldo Awal</th>
          <th>Setoran Awal</th>
          <th>Setoran Perbulan</th>
          <th>Bunga</th>
          <th>Pajak</th>
          <th>Bunga Bersih</th>
          <th>Saldo Akhir</th>
        </tr>
      </thead>
      <tbody>
        ${rows.map(r=>`
          <tr>
            <td>${r.bulan}</td>
            <td>${formatRupiah(r.saldoAwal)}</td>
            <td>${formatRupiah(r.setoranAwal)}</td>
            <td>${formatRupiah(r.setoran)}</td>
            <td>${formatRupiah(r.bungaKotor)}</td>
            <td>${formatRupiah(r.pajak)}</td>
            <td>${formatRupiah(r.bungaBersih)}</td>
            <td>${formatRupiah(r.saldo)}</td>
          </tr>`).join('')}
      </tbody>
    </table>
    <div class="footer-note">
  <b>Catatan:</b><br/>
  1. Sesuai dengan ketentuan perpajakan mengenai simpanan tabungan, saldo/hasil di atas Rp7.500.000 dikenakan pajak sesuai peraturan yang berlaku.<br/>
  2. Hasil simulasi ini menggambarkan perhitungan dengan Asumsi untuk 1 (satu) rekening / Nasabah, baik tabungan maupun deposito.<br/>
  3. Suku bunga dapat berubah sewaktu-waktu mengikuti ketentuan yang berlaku.<br/>
  4. Perhitungan ini hanya merupakan simulasi, hasil sebenarnya dapat berbeda sesuai kondisi dan data aktual.
</div>
    `;
    container.classList.remove('hidden');
  }

  function setupHandlers(){
    attachThousandHandlers();
    document.getElementById('btn-cordelia').addEventListener('click',()=>{
      const tenor=+document.getElementById('cordelia-tenor').value;
      const setoran=parseThousandInput(document.getElementById('cordelia-setoran'));
      const out=document.getElementById('cordelia-result');
      if(!tenor||!setoran){alert('Mohon isi tenor dan setoran per bulan.');return;}
      const {rows,ringkasan}=simulasiBulanan({setoranBulanan:setoran,tenorTahun:tenor,bungaTahunan:0.01});
      renderTabel(out,rows,ringkasan);
    });
    document.getElementById('btn-elara').addEventListener('click',()=>{
      const tenor=+document.getElementById('elara-tenor').value;
      const setoran=parseThousandInput(document.getElementById('elara-setoran'));
      const out=document.getElementById('elara-result');
      if(!tenor||!setoran){alert('Mohon isi tenor dan setoran per bulan.');return;}
      const {rows,ringkasan}=simulasiBulanan({setoranBulanan:setoran,tenorTahun:tenor,bungaTahunan:0.04});
      renderTabel(out,rows,ringkasan);
    });
    document.getElementById('btn-elaraAwal').addEventListener('click',()=>{
      const tenor=+document.getElementById('elaraAwal-tenor').value;
      const setoranAwal=parseThousandInput(document.getElementById('elaraAwal-setoranAwal'));
      const setoran=parseThousandInput(document.getElementById('elaraAwal-setoran'));
      const out=document.getElementById('elaraAwal-result');
      if(!tenor||(!setoranAwal&&!setoran)){alert('Mohon isi minimal setoran.');return;}
      const {rows,ringkasan}=simulasiBulanan({setoranBulanan:setoran,tenorTahun:tenor,bungaTahunan:0.05,setoranAwal:setoranAwal});
      renderTabel(out,rows,ringkasan);
    });
  }
  document.addEventListener('DOMContentLoaded',setupHandlers);
</script>
</body>
</html>
